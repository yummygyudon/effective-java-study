# [Item 5] 자원을 직접 명시하지 말고 "의존 객체 주입" 하라.
<details open>
    <summary><b>Index</b></summary>
<div markdown="1">

- [의존 객체 주입 패턴](#의존-객체-주입-패턴)
- [팩토리 메서드 패턴](#팩토리-메서드-패턴)

</div>
</details>

<br/>

---
## 의존 객체 주입 패턴
클래스 내에선 하나 이상의 자원에 의존하는 구조이다.

하지만 만약 사용해야 하는 <u>자원이 **동적**으로 바뀌게</u> 될 때,<br/>
`정적 팩토리`나 `싱글톤`을 활용한다면<br/>
<u>유연하지 않고 테스트하기 어려워진다</u>는 단점이 있다.<br/>
( **오류 발생률** ⬆ & **멀티 쓰레드** 환경에서 **사용 불가** ❌)

즉, <u>사용하는 자원에 따라 동작이 달라지는 클래스</u>에는<br/>
`정적 유틸리티 클래스`나 `싱글톤 방식`은 **적절하지 않다.**

<br/>

가장 적합한 패턴은<br/>
" **인스턴스를 생성할 때** 생성자에 <u>필요한 자원을 넘겨주는</u> 패턴 "이다.

- 자원이 몇 개든 의존 관계가 어떻든 상관없이 작동
- 불변 보장 → 여러 클라이언트는 의존 객체 공유 용이

> 의존 객체 주입은 `생성자`, `정적 팩토리`, `빌더` 모두 활용 가능

<br/>

---
## 팩토리 메서드 패턴
> : `Factory Method` Pattern 
> 
> **생성자**에 <u>**자원 팩토리**를 넘겨주는</u> 방식<br/><br/>
> _* **팩토리** : <u>호출할 때마다</u> **특정 타입의 인스턴스**를 **반복**해서 만들어주는 객체_

의존 객체 주입 패턴의 변형 패턴으로<br/>
Java 8부터 사용 가능한 <u>`Supplier<T>` 인터페이스</u>가 그 예다.

해당 `Supplier<T>`를 입력으로 받는 메서드는<br/>
일반적으로 `한정적 와일드 카드(Bounded Wildcard Type)`을 사용하여<br/>
팩토리의 <u>**타입 매개변수**를 제한</u>해야 한다.

이를 통해 클라이언트는 자신이 **명시한 타입의 하위 타입이라면 무엇이든** 생성할 수 있는 팩토리를 넘길 수 있다.
```java
// 한정적 와일드 카드(Bounded Wildcard Type) <? extends LegoBlock>을 통해
// LegoBlock 클래스 타입과 그 하위 타입의 객체들을 모두 사용할 수 있다.
Lego build(Supplier<? extends LegoBlock> legoBox)
```
---
### ⁜ 주의 점
의존 객체 주입은<br/>
**추상화 의존 가능**을 통해 **유연성**을,<br/>
**다양한 주입**이 가능함에 따라 **테스트 용이성**을 개선해주지만<br/>
의존성이 많아질 수록 <u>코드의 **가독성**은 떨어지고 **복잡성**은 높아질</u> 수 밖에 없다.

이에 따라 `대거(Dagger`. `주스(Guice)`, `스프링(Spring)`과 같은<br/>
**의존 객체 주입 프레임워크**를 통해 해소할 수 있다.